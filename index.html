<!DOCTYPE html>
<html>
<head>
  <title>Survey</title>
</head>
  <body>
<div id="consentForm">
  <h2>Consent Form</h2>
  <p><strong>NEW JERSEY INSTITUTE OF TECHNOLOGY</strong><br>
  323 MARTIN LUTHER KING BLVD.<br>
  NEWARK, NJ 07102</p>

  <p><strong>CONSENT TO PARTICIPATE IN A RESEARCH STUDY</strong></p>

  <p><strong>TITLE OF STUDY:</strong><br>
  I have been asked to participate in a research study under the direction of Dr(s). Yi Chen and Cristian Borcea.</p>

  <p><strong>PURPOSE:</strong><br>
  The goal of this study is to evaluate the effectiveness of existing brand safety tools that are used to evaluate whether online content is safe for advertisers. Advertisers do not want to risk their brand reputation by placing their products’ or services’ advertisements next to risky or unsafe content. However, inconsistency between the ratings of different brand safety tools has been reported, and this study aims to determine if the inconsistent ratings are a result of inaccuracy and unfairness in brand safety tools.</p>

  <p><strong>DURATION:</strong><br>
  My participation in this study will last for around 10-15 minutes.</p>

  <p>I have been told that my participation in this research study is important for the success of the research and that the results of this research study are expected to produce the following benefits to society and for me as a subject.</p>

  <p><strong>BENEFITS FOR SOCIETY AND THE SUBJECT:</strong><br>
  I have been told that the benefits are a better understanding of the online advertising ecosystem, and specifically brand safety ratings for news articles. This study aims to uncover inaccuracies and unfairness in brand safety ratings of news content, which could result in online publishers’ content being wrongly devalued through lower advertising revenues.</p>

  <p><strong>PROCEDURES:</strong><br>
  I have been told that, during the course of this study, the following will occur:<br><br>
  I will be asked to read four news articles and then provide my opinion on whether the article contains any content relating to potentially “unsafe” categories such as violence, drugs/alcohol, or offensive language.</p>

  <p><strong>PARTICIPANTS:</strong><br>
  I will be one of about 500 participants in this study.</p>

  <p><strong>EXCLUSIONS:</strong><br>
  I will inform the researcher if any of the following apply to me:<br><br>
  I am not proficient in reading and understanding the English language.</p>

  <p><strong>RISKS/DISCOMFORTS:</strong><br>
  I have been told that the study described above may involve the following risks and/or discomforts:<br><br>
  Some of the news articles may contain disturbing content, including, but not limited to violence, crime, adult content, drugs/alcohol, offensive language, hate speech, sensitive social issues, politics, military conflict, death and/or injury, and natural disasters.<br><br>
  If at any point this content becomes too distressing for any reason, I understand that I am able to remove myself from the study.<br><br>
  There also may be risks and discomforts that are not yet known.<br><br>
  I fully recognize that there are risks that I may be exposed to by volunteering in this study which are inherent in participating in any study; I understand that I am not covered by NJIT’s insurance policy for any injury or loss I might sustain in the course of participating in the study.</p>

  <p><strong>CONFIDENTIALITY:</strong><br>
  I understand confidential is not the same as anonymous. Confidential means that my name will not be disclosed if there exists a documented linkage between my identity and my responses as recorded in the research records. Every effort will be made to maintain the confidentiality of my study records. If the findings from the study are published, I will not be identified by name. My identity will remain confidential unless disclosure is required by law.</p>

  <p><strong>PAYMENT FOR PARTICIPATION:</strong><br>
  I have been told that I will receive $1.50 compensation for my participation in this study.</p>

  <p><strong>RIGHT TO REFUSE OR WITHDRAW:</strong><br>
  I understand that my participation is voluntary and I may refuse to participate, or may discontinue my participation at any time with no adverse consequence. I also understand that the investigator has the right to withdraw me from the study at any time.</p>

  <p><strong>INDIVIDUAL TO CONTACT:</strong><br>
  If I have any questions about my treatment or research procedures, I understand that I should contact the principal investigator at:<br><br>
  Address: CAB 2008, University Heights, Newark, NJ 07102<br>
  Email: yi.chen@njit.edu<br>
  Phone: 973-596-6302</p>

  <p>If I have any additional questions about my rights as a research subject, I may contact:<br><br>
  Office of Research<br>
  New Jersey Institute of Technology<br>
  323 Martin Luther King Boulevard<br>
  Newark, NJ 07102<br>
  973-596-5275<br>
  irb@njit.edu (email is preferred)</p>

  <p><strong>SIGNATURE OF PARTICIPANT</strong><br><br>
I have read this entire form, or it has been read to me, and I understand it completely. All of my questions regarding this form or this study have been answered to my complete satisfaction. I agree to participate in this research study.</p>

<label>
  <input type="checkbox" id="signatureCheckbox"> By clicking this box I acknowledge and agree with the above statement.
</label>
<br><br>
<button id="startSurvey" disabled>Start Survey</button>
</div>






<div id="instructionsSection" style="display: none;">
    <h2>Instructions</h2>
    <p>Please read the following instructions carefully before proceeding with the survey:</p>
    <ul>
      <li>You will be shown four news articles. Each article is only provided as a URL, so you must copy and paste the URL into your browser to open the article. Read the article in the new tab and then return to this tab to answer the questions. DO NOT CLOSE the survey while reading the articles. </li>
      <li>Your task is to evaluate each of the four articles and select the categories (out of 12 brand safety categories) that apply to the content. If no categories apply, you can select the option titled "None"</li>
      <li>For each article, you will be required to spend at least 90 seconds reading it before being able to submit your response. If it takes longer, that is fine because you are given up to 1 hour to complete this task, which is plenty of time. </li>
      <li>Ensure you take your time to read the article carefully before selecting any categories.</li>
      <li>You are able to withdraw your participation in this study at any point for any reason, including if the news article content you are reading causes you distress.</li>
      <li>At the end of the survey, the webpage will print out your responses to each of the four articles. YOU MUST COPY THIS TEXT AND PASTE IT IN THE DESIGNATED BOX IN THE MTURK INTERFACE. This is how we confirm that the survey was completed and will approve the HIT. FAILURE TO DO THIS MEANS YOU WILL NOT BE PAID.</li>
    </ul>
    <button id="startSurveyFromInstructions">Start Survey</button>
  </div>













    




    
<div id="surveySection" style="display: none;">
  <h2>News Article Survey</h2>

  <p>Read the following article:</p>
  <div id="article"></div>

 <form id="surveyForm">
  <p>Select all categories that apply to this article:</p>
  
  <div id="categories">
    <label><input type="checkbox" name="categories" value="Adult & Explicit Sexual Content"> Adult & Explicit Sexual Content</label><br>
    <label><input type="checkbox" name="categories" value="Arms & Ammunition"> Arms & Ammunition</label><br>
    <label><input type="checkbox" name="categories" value="Crime & Harmful Acts to Individuals and Society"> Crime & Harmful Acts</label><br>
    <label><input type="checkbox" name="categories" value="Death, Injury, or Military Conflict"> Death, Injury, or Military Conflict</label><br>
    <label><input type="checkbox" name="categories" value="Online Piracy"> Online Piracy</label><br>
    <label><input type="checkbox" name="categories" value="Hate Speech & Acts of Aggression"> Hate Speech & Aggression</label><br>
    <label><input type="checkbox" name="categories" value="Obscenity & Profanity"> Obscenity & Profanity</label><br>
    <label><input type="checkbox" name="categories" value="Illegal Drugs/Tobacco/E-Cigarettes/Alcohol">Illegal Drugs/Tobacco/E-Cigarettes/Alcohol</label><br>
    <label><input type="checkbox" name="categories" value="Spam or Harmful Content"> Spam or Harmful Content</label><br>
    <label><input type="checkbox" name="categories" value="Terrorism"> Terrorism</label><br>
    <label><input type="checkbox" name="categories" value="Sensitive Social Issues"> Sensitive Social Issues</label><br>
    <label><input type="checkbox" name="categories" value="Misinformation"> Misinformation</label><br>
    <label><input type="checkbox" name="categories" value="None"> None</label><br>
  </div>

  <p><input type="submit" id="submitButton" value="Submit Survey"></p>
</form>

<div id="result1" style="margin-top: 20px;"></div>
<div id="result2" style="margin-top: 20px;"></div>
</div>

<script>
let responses=[];
const checkbox = document.getElementById('signatureCheckbox');
const startButton = document.getElementById('startSurvey');
const surveySection = document.getElementById('surveySection');
const articleDiv = document.getElementById('article');
const result1Div = document.getElementById('result1');
const result2Div = document.getElementById('result2');
const submitButton = document.getElementById('submitButton');
const instructionsSection = document.getElementById('instructionsSection');
const instructionsbutton = document.getElementById('startSurveyFromInstructions');
//const allArticles = [
 // "https://openaccess.thecvf.com/content_ICCV_2019/papers/Zhao_Optimizing_the_F-Measure_for_Threshold-Free_Salient_Object_Detection_ICCV_2019_paper.pdf",
//  "https://en.wikipedia.org/wiki/Weber%E2%80%93Fechner_law",
//  "https://news.google.com/home?hl=en-US&gl=US:en",
//  "https://www.bbc.com/news/world",
//  "https://www.nature.com/articles/d41586-020-00154-w"
//  // Add more URLs here
//];
  
let allArticles = [];
let selectedArticles = [];
let currentIndex = 0;

// Enable Start button when checkbox is checked
checkbox.addEventListener('change', () => {
  startButton.disabled = !checkbox.checked;
});

// When Start is clicked: pick 3 unique articles, show first
//startButton.addEventListener('click', () => {
//  document.getElementById('consentForm').style.display = 'none';
//  surveySection.style.display = 'block';






startButton.addEventListener('click', () => {
      document.getElementById('consentForm').style.display = 'none';
      instructionsSection.style.display = 'block';
    });

    // When "Start Survey" is clicked from instructions page: show survey section
instructionsbutton.addEventListener('click', () => {
  instructionsSection.style.display = 'none';
  surveySection.style.display = 'block';

  fetch('articles.json')
    .then(response => response.json())
    .then(data => {
      allArticles = data.articles;

      // Randomly select 3 articles without replacement
      selectedArticles = shuffleArray(allArticles).slice(0, 4);
      currentIndex = 0;
      showArticle();
    })
    .catch(error => {
      console.error('Error loading articles:', error);
      articleDiv.innerHTML = '<strong>Failed to load articles. Please try again later.</strong>';
    });
});
  // Randomly select 3 articles without replacement
  //selectedArticles = shuffleArray(allArticles).slice(0, 4);

 // currentIndex = 0;
 // showArticle();
//});

// Handle survey submission
document.getElementById('surveyForm').addEventListener('submit', function(e) {
  e.preventDefault();
  submitButton.disabled = true;
  //const score = document.querySelector('select[name="interest"]').value;
  const currentArticle = selectedArticles[currentIndex];
  const selectedCategories = Array.from(document.querySelectorAll('input[name="categories"]:checked'))
    .map(cb => cb.value);

  // Show which article was reviewed
  result1Div.innerHTML = '';
  result2Div.innerHTML = `Submitting your response...`;

  const data = {
    article: currentArticle,
    score: selectedCategories
  };

  responses.push({
  article: currentArticle,
  score: selectedCategories});

  // SEND the data (no-cors mode)
  fetch('https://script.google.com/macros/s/AKfycbzUxjDa_8q6iqvDVF_bQG_W0ncm90qxGMeVmsVYKUCL_CFL-wFHGaLZXLG4Yd_AcnwU/exec', {
     method: 'POST',
     body: JSON.stringify(data),
     headers: {
       'Content-Type': 'application/json'
     },
     mode: 'no-cors'  // CORS disabled
   })
   .then(() => {
     // We don't know the real status in no-cors mode, but assume success if no error is thrown
     result2Div.innerHTML = `<strong>Thank you! Your response has been recorded.</strong>`;
 

    currentIndex++;

    // Check if there are more articles left
    if (currentIndex < selectedArticles.length) {
      setTimeout(() => {
        result1Div.innerHTML = '';
        result2Div.innerHTML = '';
        showArticle();
        submitButton.disabled = false;
      }, 1000); // 1 second pause before showing next article
    } else {
      // All done
      setTimeout(() => {
  articleDiv.innerHTML = '';
  document.getElementById('surveyForm').style.display = 'none';

  let summaryHTML = '<strong>Survey complete! Thank you for participating.</strong><br><br>';
  summaryHTML += '<strong>COPY THE FOLLOWING TEXT (1-4) AND PASTE IT IN THE MTURK INTERFACE TO PROVE YOU COMPLETED THE SURVEY</strong><br>';

  responses.forEach((response, index) => {
    summaryHTML += `${index + 1}. <a href="${response.article}" target="_blank">${response.article}</a><br>Rating: ${response.score}<br><br>`;
  });

  result2Div.innerHTML = summaryHTML;
}, 1000);
    }
  })
  .catch(error => {
    submitButton.disabled = false;
    console.error('Error submitting the request:', error);
    result2Div.innerHTML = `<strong>Error submitting your response. Please try again.</strong>`;
  });
});

// Show current article
function showArticle() {
  const article = selectedArticles[currentIndex];
  articleDiv.innerText = article;
  clearCheckboxes(); 


  submitButton.disabled = true;
  submitButton.value = "You must actually read the article";

  // Enable after 90 seconds
  setTimeout(() => {
    submitButton.disabled = false;
    submitButton.value = "Submit Survey";
  }, 20000); // 90,000 milliseconds = 90 seconds
}

// Fisher-Yates shuffle to randomize array
function shuffleArray(array) {
  const arr = array.slice(); // copy array
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

function clearCheckboxes() {
  document.querySelectorAll('input[name="categories"]').forEach(cb => cb.checked = false);
}









  
</script>

    
</body>
</html>
